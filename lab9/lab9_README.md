The based structure of the code is done in collaboration with Edoardo Vay 316737.
